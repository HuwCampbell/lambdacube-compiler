main :: Int
main = 31
------------ desugared source code
infixr 0 $

($) = _lhs ($) \(a :: _) (b :: _) -> _rhs (a b)

id = _lhs id \(a :: _) -> _rhs a

foldr
  = primFix
    \(a :: _) -> _lhs
      foldr
      \(b :: _) (c :: _) (d :: _) -> case'List
        (\(_ :: _) -> _)
        (_rhs c)
        (\(e :: _) (f :: _) -> _rhs (b e $ a b c f))
        d

filter
  = _lhs
    filter
    \(a :: _) -> _rhs
      (foldr (\(b :: _) (c :: _) -> primIfThenElse (a b) (b : c) c) [])

(&&)
  = _lhs
    (&&)
    \(a :: _) (b :: _) -> case'Bool (\(_ :: _) -> _) (_rhs False) (_rhs b) a

and = _lhs and (_rhs (foldr (&&) True))

map = _lhs map \(a :: _) -> _rhs (foldr (\(b :: _) (c :: _) -> a b : c) [])

mod = _lhs mod (_rhs primModInt)

iSqrt
  = _lhs iSqrt \(a :: _) -> _rhs (primRound (primSqrtFloat (primIntToFloat a)))

(+) = _lhs (+) (_rhs primAddInt)

(-) = _lhs (-) (_rhs primSubInt)

(<=)
  = _lhs
    (<=)
    \(a :: _) (b :: _) -> _rhs
      ((\(c :: _) -> case'Ordering (\(_ :: _) -> _) True True False c)
        (primCompareInt a b))

not
  = _lhs not \(a :: _) -> case'Bool (\(_ :: _) -> _) (_rhs True) (_rhs False) a

(/=) = _lhs (/=) \(a :: _) (b :: _) -> _rhs (not $ a == b)

takeWhile
  = primFix
    \(a :: _) -> _lhs
      takeWhile
      \(b :: _) (c :: _) -> case'List
        (\(_ :: _) -> _)
        (_rhs [])
        (\(d :: _) (e :: _) -> case'Bool
          (\(_ :: _) -> _)
          (_rhs [])
          (_rhs (d : a b e))
          (b d))
        c

from = primFix \(a :: _) -> _lhs from \(b :: _) -> _rhs (b : a (b + fromInt 1))

primes :: [Int]
primes
  = primFix
    \(a :: [Int]) -> _lhs
      primes
      (_rhs
        (fromInt 2
          : fromInt 3
            : filter
              (\(b :: _) -> and
                $ map
                  (\(c :: _) -> b `mod` c /= fromInt 0)
                  (takeWhile (\(d :: _) -> d <= iSqrt b) a))
              (from (fromInt 5))))

(!!)
  = primFix
    \(a :: _) -> _lhs
      (!!)
      \(b :: _) (c :: _) -> case'List
        (\(_ :: _) -> _)
        (_rhs undefined)
        (\(d :: _) (e :: _) -> case'Bool
          (\(_ :: _) -> _)
          (_rhs (a e (c - fromInt 1)))
          (_rhs d)
          (fromInt 0 == c))
        b

main = _lhs main (_rhs (primes !! fromInt 10))
------------ core code
!! :: forall a . [a] -> Int -> a
!!
  = \a -> primFix
    _
    \b c d -> case'List
      (\_ -> a)
      (_rhs (undefined a))
      (\e f -> case'Bool
        (\_ -> a)
        (_rhs (b f (primSubInt d 1)))
        (_rhs e)
        (isEQ (primCompareInt 0 d)))
      c

$ :: forall a b . (a -> b) -> a -> b
$ = \a b c d -> _rhs (c d)

&& :: Bool -> Bool -> Bool
&& = \a b -> case'Bool (\_ -> 'Bool) (_rhs False) (_rhs b) a

+ :: Int -> Int -> Int
+ = _rhs \a b -> primAddInt a b

- :: Int -> Int -> Int
- = _rhs \a b -> primSubInt a b

/= :: forall a . Eq a => a -> a -> Bool
/= = \a b c d -> _rhs (not ((a == b) c d))

<= :: Int -> Int -> Bool
<=
  = \a b -> _rhs
    (case'Ordering (\_ -> 'Bool) True True False (primCompareInt a b))

and :: [Bool] -> Bool
and = _rhs (foldr (&&) True)

filter :: forall a . (a -> Bool) -> [a] -> [a]
filter = \a b -> _rhs (foldr (\c d -> primIfThenElse [a] (b c) (c : d) d) [])

foldr :: forall a b . (b -> a -> a) -> a -> [b] -> a
foldr
  = \a b -> primFix
    _
    \c d e f -> case'List (\_ -> a) (_rhs e) (\g h -> _rhs (d g (c d e h))) f

from :: Int -> [Int]
from = primFix _ \a b -> _rhs (b : a (primAddInt b 1))

iSqrt :: Int -> Int
iSqrt = \a -> _rhs (primRound (primSqrtFloat (primIntToFloat a)))

id :: forall a . a -> a
id = \a b -> _rhs b

main :: Int
main = _rhs 31

map :: forall a b . (a -> b) -> [a] -> [b]
map = \a b c -> _rhs (foldr (\d e -> c d : e) [])

mod :: Int -> Int -> Int
mod = _rhs \a b -> primModInt a b

not :: Bool -> Bool
not = \a -> case'Bool (\_ -> 'Bool) (_rhs True) (_rhs False) a

primes :: [Int]
primes
  = primFix
    _
    \a -> _rhs
      (2
        : 3
          : foldr
            (\b c -> primIfThenElse
              ['Int]
              (and
                $ foldr (\d e -> primModInt b d /= 0 : e) [] (takeWhile (\f -> f <= iSqrt b) a))
              (b : c)
              c)
            []
            (from 5))

takeWhile :: forall a . (a -> Bool) -> [a] -> [a]
takeWhile
  = \a -> primFix
    _
    \b c d -> case'List
      (\_ -> [a])
      (_rhs [])
      (\e f -> case'Bool (\_ -> [a]) (_rhs []) (_rhs (e : b c f)) (c e))
      d
------------ tooltips
testdata/primes.lc 7:3-7:4
    forall a b . (a -> b) -> a -> b
testdata/primes.lc 7:9-7:10
    _d
testdata/primes.lc 7:11-7:12
    _e
testdata/primes.lc 9:1-9:3
    forall a . a -> a
testdata/primes.lc 9:8-9:9
    _b
testdata/primes.lc 11:1-11:6
    forall a b . (b -> a -> a) -> a -> [b] -> a
testdata/primes.lc 11:16-11:17
    _f
testdata/primes.lc 11:16-12:39
    [_b] -> _f
testdata/primes.lc 12:21-12:22
    _k
testdata/primes.lc 12:21-12:26
    _b -> _a
testdata/primes.lc 12:21-12:39
    _h
testdata/primes.lc 12:23-12:24
    _h
testdata/primes.lc 12:25-12:26
    forall a b . (a -> b) -> a -> b
testdata/primes.lc 12:27-12:32
    _k
testdata/primes.lc 12:33-12:34
    _g -> _d -> _k
testdata/primes.lc 12:35-12:36
    _l
testdata/primes.lc 12:37-12:39
    [_h]
testdata/primes.lc 19:1-19:7
    forall a . (a -> Bool) -> [a] -> [a]
testdata/primes.lc 19:12-19:17
    forall a b . (b -> a -> a) -> a -> [b] -> a
testdata/primes.lc 19:12-19:54
    [_a] -> [_a] -> [_a]
testdata/primes.lc 19:12-19:57
    [_a] -> [_a]
testdata/primes.lc 19:28-19:53
    [_c]
testdata/primes.lc 19:31-19:32
    _g
testdata/primes.lc 19:31-19:45
    [_c] -> [_c]
testdata/primes.lc 19:33-19:34
    _g
testdata/primes.lc 19:40-19:41
    _e
testdata/primes.lc 19:40-19:42
    [_d] -> [_d]
testdata/primes.lc 19:40-19:45
    [_c]
testdata/primes.lc 19:41-19:42
    forall a . a -> [a] -> [a]
testdata/primes.lc 19:43-19:45
    _d
testdata/primes.lc 19:51-19:53
    [_c]
testdata/primes.lc 19:55-19:57
    forall a . [a]
testdata/primes.lc 21:6-21:8
    Bool -> Bool -> Bool
testdata/primes.lc 21:13-21:14
    _b
testdata/primes.lc 21:13-22:19
    Bool -> Bool
testdata/primes.lc 22:14-22:19
    Bool
testdata/primes.lc 24:1-24:4
    [Bool] -> Bool
testdata/primes.lc 24:7-24:12
    forall a b . (b -> a -> a) -> a -> [b] -> a
testdata/primes.lc 24:7-24:17
    Bool -> [Bool] -> Bool
testdata/primes.lc 24:7-24:22
    [Bool] -> Bool
testdata/primes.lc 24:13-24:17
    Bool -> Bool -> Bool
testdata/primes.lc 24:18-24:22
    Bool
testdata/primes.lc 26:1-26:4
    forall a b . (a -> b) -> [a] -> [b]
testdata/primes.lc 26:9-26:14
    forall a b . (b -> a -> a) -> a -> [b] -> a
testdata/primes.lc 26:9-26:33
    [_a] -> [_b] -> [_a]
testdata/primes.lc 26:9-26:36
    [_b] -> [_a]
testdata/primes.lc 26:25-26:26
    _g
testdata/primes.lc 26:25-26:29
    [_a] -> [_a]
testdata/primes.lc 26:25-26:32
    [_a]
testdata/primes.lc 26:27-26:28
    _g
testdata/primes.lc 26:28-26:29
    forall a . a -> [a] -> [a]
testdata/primes.lc 26:30-26:32
    [_a]
testdata/primes.lc 26:34-26:36
    forall a . [a]
testdata/primes.lc 28:1-28:4
    Int -> Int -> Int
testdata/primes.lc 28:7-28:17
    Int -> Int -> Int
testdata/primes.lc 29:1-29:6
    Int -> Int
testdata/primes.lc 29:11-29:20
    Float -> Int
testdata/primes.lc 29:11-29:55
    Int
testdata/primes.lc 29:22-29:35
    Float -> Float
testdata/primes.lc 29:22-29:54
    Float
testdata/primes.lc 29:37-29:51
    Int -> Float
testdata/primes.lc 29:37-29:53
    Float
testdata/primes.lc 29:52-29:53
    _b
testdata/primes.lc 30:2-30:3
    Int -> Int -> Int
testdata/primes.lc 30:7-30:17
    Int -> Int -> Int
testdata/primes.lc 31:2-31:3
    Int -> Int -> Int
testdata/primes.lc 31:7-31:17
    Int -> Int -> Int
testdata/primes.lc 33:3-33:5
    Int -> Int -> Bool
testdata/primes.lc 33:10-35:14
    Bool
testdata/primes.lc 33:15-33:29
    Int -> Int -> Ordering
testdata/primes.lc 33:15-33:31
    Int -> Ordering
testdata/primes.lc 33:15-33:33
    Ordering
testdata/primes.lc 33:30-33:31
    _d
testdata/primes.lc 33:32-33:33
    _b
testdata/primes.lc 34:11-34:16
    Bool
testdata/primes.lc 34:11-35:14
    Ordering -> Bool
testdata/primes.lc 35:10-35:14
    Bool | Bool
testdata/primes.lc 37:1-37:4
    Bool -> Bool
testdata/primes.lc 37:13-37:17
    Bool
testdata/primes.lc 37:13-38:17
    Bool -> Bool
testdata/primes.lc 38:12-38:17
    Bool
testdata/primes.lc 40:3-40:5
    forall a . Eq a => a -> a -> Bool
testdata/primes.lc 40:10-40:13
    Bool -> Bool
testdata/primes.lc 40:10-40:15
    Bool -> Bool
testdata/primes.lc 40:10-40:22
    Bool
testdata/primes.lc 40:14-40:15
    forall a b . (a -> b) -> a -> b
testdata/primes.lc 40:16-40:17
    _f
testdata/primes.lc 40:16-40:20
    _e -> Bool
testdata/primes.lc 40:16-40:22
    Bool
testdata/primes.lc 40:18-40:20
    forall a . Eq a => a -> a -> Bool
testdata/primes.lc 40:21-40:22
    _c
testdata/primes.lc 42:1-42:10
    forall a . (a -> Bool) -> [a] -> [a]
testdata/primes.lc 42:23-42:24
    _g
testdata/primes.lc 42:23-43:19
    [_c]
testdata/primes.lc 42:25-42:26
    _f
testdata/primes.lc 42:29-42:30
    _f
testdata/primes.lc 42:29-42:31
    [_e] -> [_e]
testdata/primes.lc 42:29-42:46
    [_d]
testdata/primes.lc 42:29-43:19
    Bool -> [_d]
testdata/primes.lc 42:30-42:31
    forall a . a -> [a] -> [a]
testdata/primes.lc 42:32-42:41
    _j
testdata/primes.lc 42:42-42:43
    _k
testdata/primes.lc 42:44-42:46
    [_h]
testdata/primes.lc 43:17-43:19
    forall a . [a] | forall a . [a]
testdata/primes.lc 45:1-45:5
    Int -> [Int]
testdata/primes.lc 45:10-45:11
    _c
testdata/primes.lc 45:10-45:12
    [_b] -> [_b]
testdata/primes.lc 45:10-45:25
    [Int]
testdata/primes.lc 45:11-45:12
    forall a . a -> [a] -> [a]
testdata/primes.lc 45:13-45:17
    _d
testdata/primes.lc 45:19-45:20
    _e
testdata/primes.lc 45:19-45:22
    Int -> Int
testdata/primes.lc 45:19-45:24
    Int
testdata/primes.lc 45:21-45:22
    Int -> Int -> Int
testdata/primes.lc 45:23-45:24
    _b
testdata/primes.lc 47:11-47:16
    Type
testdata/primes.lc 47:12-47:15
    Type
testdata/primes.lc 48:1-48:7
    [Int]
testdata/primes.lc 48:10-48:11
    _b
testdata/primes.lc 48:10-48:12
    [_b] -> [_b]
testdata/primes.lc 48:10-48:111
    [Int]
testdata/primes.lc 48:11-48:12
    forall a . a -> [a] -> [a]
testdata/primes.lc 48:12-48:13
    _b
testdata/primes.lc 48:12-48:14
    [_b] -> [_b]
testdata/primes.lc 48:12-48:111
    [Int]
testdata/primes.lc 48:13-48:14
    forall a . a -> [a] -> [a]
testdata/primes.lc 48:15-48:21
    forall a . (a -> Bool) -> [a] -> [a]
testdata/primes.lc 48:15-48:102
    [Int] -> [Int]
testdata/primes.lc 48:15-48:111
    [Int]
testdata/primes.lc 48:29-48:32
    [Bool] -> Bool
testdata/primes.lc 48:29-48:34
    [Bool] -> Bool
testdata/primes.lc 48:29-48:101
    Bool
testdata/primes.lc 48:33-48:34
    forall a b . (a -> b) -> a -> b
testdata/primes.lc 48:35-48:38
    forall a b . (a -> b) -> [a] -> [b]
testdata/primes.lc 48:35-48:61
    [Int] -> [Bool]
testdata/primes.lc 48:35-48:101
    [Bool]
testdata/primes.lc 48:46-48:47
    _g
testdata/primes.lc 48:46-48:53
    Int -> Int
testdata/primes.lc 48:46-48:55
    Int
testdata/primes.lc 48:46-48:58
    Int -> Bool
testdata/primes.lc 48:46-48:60
    Bool
testdata/primes.lc 48:48-48:53
    Int -> Int -> Int
testdata/primes.lc 48:54-48:55
    _d
testdata/primes.lc 48:56-48:58
    forall a . Eq a => a -> a -> Bool
testdata/primes.lc 48:59-48:60
    _b
testdata/primes.lc 48:63-48:72
    forall a . (a -> Bool) -> [a] -> [a]
testdata/primes.lc 48:63-48:93
    [Int] -> [Int]
testdata/primes.lc 48:63-48:100
    [Int]
testdata/primes.lc 48:80-48:81
    _b
testdata/primes.lc 48:80-48:84
    Int -> Bool
testdata/primes.lc 48:80-48:92
    Bool
testdata/primes.lc 48:82-48:84
    Int -> Int -> Bool
testdata/primes.lc 48:85-48:90
    Int -> Int
testdata/primes.lc 48:85-48:92
    Int
testdata/primes.lc 48:91-48:92
    Int
testdata/primes.lc 48:94-48:100
    [Int]
testdata/primes.lc 48:104-48:108
    Int -> [Int]
testdata/primes.lc 48:104-48:110
    [Int]
testdata/primes.lc 48:109-48:110
    _b
testdata/primes.lc 50:8-50:10
    forall a . [a] -> Int -> a
testdata/primes.lc 50:15-50:16
    _e
testdata/primes.lc 50:15-51:28
    Bool -> _d | _c
testdata/primes.lc 51:17-51:19
    [_h]
testdata/primes.lc 51:20-51:22
    _k
testdata/primes.lc 51:24-51:25
    _k
testdata/primes.lc 51:24-51:26
    Int -> Int
testdata/primes.lc 51:24-51:27
    Int
testdata/primes.lc 51:25-51:26
    Int -> Int -> Int
testdata/primes.lc 51:26-51:27
    _b
testdata/primes.lc 53:1-53:5
    Int
testdata/primes.lc 53:8-53:14
    [Int]
testdata/primes.lc 53:8-53:17
    Int -> Int
testdata/primes.lc 53:8-53:20
    Int
testdata/primes.lc 53:15-53:17
    forall a . [a] -> Int -> a
testdata/primes.lc 53:18-53:20
    _b
------------ warnings
Uncovered pattern(s) at testdata/primes.lc:50:8:
(x: _) !! 0 = x
(_ : xs) !! n = xs !! (n-1)
Missing case(s):
    [] !! _